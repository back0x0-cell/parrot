<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>VOID CORE ‚Äî –¢–∞–ø–∞–ª–∫–∞</title>
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;500;600;700;800;900&family=Rajdhani:wght@400;500;600;700&family=Aldrich&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #06060f;
  --bg2: #09091a;
  --bg3: #0d0d22;
  --card: #10102a;
  --card2: #14143a;
  --border: #1e1e4a;
  --border2: #2a2a6a;
  --accent: #5b8af5;
  --accent2: #a855f7;
  --accent3: #22d3ee;
  --gold: #f59e0b;
  --green: #10b981;
  --red: #ef4444;
  --text: #c8d5ff;
  --muted: #5060a0;
  --dim: #2a3060;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none}
html,body{width:100%;height:100%;overflow:hidden;background:var(--bg);font-family:'Exo 2',sans-serif;color:var(--text)}

/* STARS BG */
body::before{
  content:'';position:fixed;inset:0;
  background:radial-gradient(ellipse at 20% 20%,rgba(91,138,245,.08) 0,transparent 50%),
             radial-gradient(ellipse at 80% 80%,rgba(168,85,247,.08) 0,transparent 50%),
             radial-gradient(ellipse at 50% 50%,rgba(34,211,238,.04) 0,transparent 70%);
  pointer-events:none;z-index:0;
}

/* LAYOUT */
.app{display:flex;flex-direction:column;height:100vh;position:relative;z-index:1;max-width:430px;margin:0 auto}

/* TOP BAR */
.topbar{
  padding:10px 16px 8px;
  background:linear-gradient(180deg,rgba(6,6,15,1) 0%,rgba(6,6,15,0) 100%);
  display:flex;align-items:center;gap:10px;flex-shrink:0;
}
.tb-avatar{
  width:38px;height:38px;border-radius:50%;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  display:flex;align-items:center;justify-content:center;font-size:18px;
  box-shadow:0 0 12px rgba(91,138,245,.5);flex-shrink:0;
  border:2px solid rgba(91,138,245,.3);
}
.tb-info{flex:1}
.tb-name{font-weight:700;font-size:14px;color:white;line-height:1}
.tb-league{font-size:11px;color:var(--accent);font-family:'Aldrich',monospace;letter-spacing:.5px;margin-top:2px}
.tb-coins{
  display:flex;align-items:center;gap:6px;
  background:rgba(245,158,11,.08);border:1px solid rgba(245,158,11,.2);
  border-radius:20px;padding:5px 12px;
}
.tb-coins span{font-family:'Aldrich',monospace;font-size:13px;font-weight:700;color:var(--gold)}
.coin-icon{font-size:16px}

/* PAGES */
.pages{flex:1;overflow:hidden;position:relative}
.page{position:absolute;inset:0;overflow-y:auto;display:none;padding-bottom:80px}
.page.active{display:block}
.page::-webkit-scrollbar{width:0}

/* NAV */
.bottomnav{
  flex-shrink:0;height:68px;
  background:rgba(9,9,26,.95);
  border-top:1px solid var(--border);
  display:flex;align-items:center;
  backdrop-filter:blur(20px);
  position:relative;z-index:10;
}
.nav-btn{
  flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:3px;cursor:pointer;padding:8px 4px;transition:all .2s;position:relative;
}
.nav-btn .nav-icon{font-size:22px;transition:transform .2s}
.nav-btn .nav-label{font-size:9px;color:var(--muted);letter-spacing:.5px;font-family:'Aldrich',monospace;transition:color .2s}
.nav-btn.active .nav-label{color:var(--accent)}
.nav-btn.active .nav-icon{transform:scale(1.15)}
.nav-btn.active::after{
  content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);
  width:30px;height:2px;background:var(--accent);border-radius:2px;
  box-shadow:0 0 8px var(--accent);
}
.nav-badge{
  position:absolute;top:4px;right:calc(50% - 16px);
  background:var(--red);color:white;font-size:8px;font-family:'Aldrich',monospace;
  width:16px;height:16px;border-radius:50%;display:flex;align-items:center;justify-content:center;
  border:1.5px solid var(--bg);
}

/* ============ TAP PAGE ============ */
.tap-page{display:flex;flex-direction:column;align-items:center;padding:0 20px}

/* RANK BANNER */
.rank-banner{
  width:100%;margin-top:12px;
  background:rgba(91,138,245,.07);border:1px solid rgba(91,138,245,.15);
  border-radius:14px;padding:10px 16px;
  display:flex;align-items:center;gap:12px;
}
.rank-icon{font-size:22px}
.rank-info{flex:1}
.rank-name{font-size:13px;font-weight:700;color:white}
.rank-progress-wrap{margin-top:4px}
.rank-bar{height:4px;background:var(--border);border-radius:2px;overflow:hidden}
.rank-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));border-radius:2px;transition:width .5s ease}
.rank-label{font-size:10px;color:var(--muted);font-family:'Aldrich',monospace;margin-top:3px}
.rank-next{font-size:11px;color:var(--accent2);font-family:'Aldrich',monospace}

/* MAIN ORB */
.orb-container{
  position:relative;margin:20px 0;
  display:flex;align-items:center;justify-content:center;
}
.orb-rings{position:absolute;width:300px;height:300px;pointer-events:none}
.orb-ring{
  position:absolute;border-radius:50%;border:1px solid;
  top:50%;left:50%;transform:translate(-50%,-50%);
}
.orb-ring-1{width:280px;height:280px;border-color:rgba(91,138,245,.15);animation:ringrot 20s linear infinite}
.orb-ring-2{width:240px;height:240px;border-color:rgba(168,85,247,.1);animation:ringrot 15s linear infinite reverse}
.orb-ring-3{width:320px;height:320px;border-color:rgba(34,211,238,.07);animation:ringrot 25s linear infinite}
@keyframes ringrot{to{transform:translate(-50%,-50%) rotate(360deg)}}
.orb-ring::before{
  content:'';position:absolute;width:6px;height:6px;border-radius:50%;top:-3px;left:50%;transform:translateX(-50%);
}
.orb-ring-1::before{background:var(--accent);box-shadow:0 0 8px var(--accent)}
.orb-ring-2::before{background:var(--accent2);box-shadow:0 0 8px var(--accent2)}

.orb{
  width:180px;height:180px;border-radius:50%;position:relative;cursor:pointer;
  background:radial-gradient(circle at 35% 35%,#4a6fff,#2030b0 40%,#0a0a40 70%,#050520);
  box-shadow:
    0 0 40px rgba(91,138,245,.4),
    0 0 80px rgba(91,138,245,.2),
    0 0 140px rgba(91,138,245,.1),
    inset 0 0 30px rgba(255,255,255,.05),
    inset -20px -20px 40px rgba(168,85,247,.2);
  transition:transform .08s,box-shadow .08s;
  z-index:2;
}
.orb::before{
  content:'';position:absolute;width:60px;height:30px;border-radius:50%;
  background:rgba(255,255,255,.12);top:25px;left:30px;
  filter:blur(8px);transform:rotate(-20deg);
}
.orb::after{
  content:'‚ú¶';position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
  font-size:60px;color:rgba(255,255,255,.7);text-shadow:0 0 20px rgba(91,138,245,1);
  animation:orbpulse 3s ease-in-out infinite;
}
@keyframes orbpulse{0%,100%{text-shadow:0 0 20px rgba(91,138,245,1),0 0 40px rgba(91,138,245,.5)}50%{text-shadow:0 0 30px rgba(168,85,247,1),0 0 60px rgba(168,85,247,.5)}}
.orb:active{transform:scale(.93);box-shadow:0 0 60px rgba(91,138,245,.8),0 0 120px rgba(91,138,245,.4),inset 0 0 40px rgba(255,255,255,.1)}

/* FLOATING NUMBERS */
.float-num{
  position:fixed;font-family:'Aldrich',monospace;font-weight:700;
  pointer-events:none;z-index:100;animation:floatUp .9s ease forwards;
  text-shadow:0 0 10px currentColor;
}
@keyframes floatUp{
  0%{opacity:1;transform:translateY(0) scale(1)}
  100%{opacity:0;transform:translateY(-90px) scale(.7)}
}

/* TAP RIPPLE */
.tap-ripple{
  position:fixed;border-radius:50%;pointer-events:none;z-index:99;
  border:2px solid rgba(91,138,245,.6);
  animation:rippleOut .5s ease forwards;
}
@keyframes rippleOut{
  0%{transform:translate(-50%,-50%) scale(.3);opacity:.8}
  100%{transform:translate(-50%,-50%) scale(2.5);opacity:0}
}

/* ENERGY */
.energy-section{width:100%;margin-top:4px}
.energy-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.energy-label{font-size:11px;color:var(--muted);font-family:'Aldrich',monospace;letter-spacing:1px}
.energy-val{font-size:13px;font-weight:700;font-family:'Aldrich',monospace}
.energy-bar-wrap{
  height:10px;background:rgba(16,16,42,.8);border-radius:10px;
  border:1px solid var(--border);overflow:hidden;position:relative;
}
.energy-bar{
  height:100%;border-radius:10px;
  background:linear-gradient(90deg,#22d3ee,#5b8af5,#a855f7);
  box-shadow:0 0 10px rgba(91,138,245,.5);
  transition:width .3s ease;
  position:relative;overflow:hidden;
}
.energy-bar::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);
  animation:shimmer 1.5s ease-in-out infinite;
}
@keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}

/* BOOSTS ROW */
.boosts-row{width:100%;display:flex;gap:8px;margin-top:12px}
.boost-card{
  flex:1;background:var(--card);border:1px solid var(--border);
  border-radius:12px;padding:10px 8px;text-align:center;cursor:pointer;
  transition:all .2s;position:relative;overflow:hidden;
}
.boost-card:hover{border-color:var(--accent2);background:rgba(168,85,247,.08)}
.boost-card.active-boost{border-color:var(--gold);background:rgba(245,158,11,.08);animation:boostPulse 1s ease-in-out infinite}
@keyframes boostPulse{0%,100%{box-shadow:none}50%{box-shadow:0 0 15px rgba(245,158,11,.3)}}
.boost-icon{font-size:20px}
.boost-name{font-size:9px;color:var(--muted);font-family:'Aldrich',monospace;margin-top:3px;letter-spacing:.3px}
.boost-cd{font-size:10px;color:var(--gold);font-family:'Aldrich',monospace;font-weight:700;margin-top:1px}
.boost-uses{
  position:absolute;top:4px;right:4px;
  background:var(--accent2);color:white;font-size:8px;font-family:'Aldrich',monospace;
  padding:1px 5px;border-radius:6px;
}

/* STATS STRIP */
.stats-strip{width:100%;display:flex;gap:8px;margin-top:10px}
.stat-chip{
  flex:1;background:var(--card);border:1px solid var(--border);
  border-radius:10px;padding:8px 6px;text-align:center;
}
.stat-chip-val{font-family:'Aldrich',monospace;font-size:13px;font-weight:700;color:white}
.stat-chip-lbl{font-size:9px;color:var(--muted);letter-spacing:.5px;margin-top:2px}

/* ============ UPGRADES PAGE ============ */
.page-header{padding:16px 20px 8px;position:sticky;top:0;background:var(--bg);z-index:5;border-bottom:1px solid rgba(30,30,74,.5)}
.page-title{font-family:'Aldrich',monospace;font-size:18px;color:white;letter-spacing:1px}
.page-sub{font-size:12px;color:var(--muted);margin-top:2px}

.upg-tabs{display:flex;gap:8px;padding:12px 20px 4px;overflow-x:auto}
.upg-tabs::-webkit-scrollbar{display:none}
.upg-tab{
  flex-shrink:0;padding:6px 14px;border-radius:20px;font-size:11px;font-family:'Aldrich',monospace;
  cursor:pointer;border:1px solid var(--border);color:var(--muted);letter-spacing:.5px;transition:all .2s;
}
.upg-tab.active{background:rgba(91,138,245,.15);border-color:var(--accent);color:var(--accent)}

.upg-grid{padding:8px 16px;display:flex;flex-direction:column;gap:10px}

.upg-item{
  background:var(--card);border:1px solid var(--border);border-radius:14px;
  padding:14px 16px;display:flex;align-items:center;gap:14px;
  cursor:pointer;transition:all .2s;position:relative;overflow:hidden;
}
.upg-item:hover:not(.locked){border-color:var(--accent);background:rgba(91,138,245,.06)}
.upg-item.locked{opacity:.45;cursor:not-allowed}
.upg-item.maxed{border-color:var(--gold);background:rgba(245,158,11,.05)}
.upg-item::before{
  content:'';position:absolute;left:0;top:0;bottom:0;width:3px;
  background:var(--item-color,var(--accent));border-radius:14px 0 0 14px;
}

.upg-icon{
  width:48px;height:48px;border-radius:12px;
  background:rgba(91,138,245,.1);border:1px solid rgba(91,138,245,.2);
  display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;
}
.upg-info{flex:1}
.upg-name{font-size:14px;font-weight:700;color:white}
.upg-desc{font-size:11px;color:var(--muted);margin-top:3px;line-height:1.4}
.upg-level{
  display:inline-flex;align-items:center;gap:4px;
  margin-top:6px;font-size:10px;font-family:'Aldrich',monospace;
  color:var(--accent2);
}
.upg-lvl-dots{display:flex;gap:3px}
.upg-lvl-dot{width:8px;height:4px;border-radius:2px;background:var(--dim)}
.upg-lvl-dot.filled{background:var(--accent2)}

.upg-right{text-align:right;flex-shrink:0}
.upg-cost{
  display:flex;align-items:center;gap:4px;justify-content:flex-end;
  font-family:'Aldrich',monospace;font-size:13px;font-weight:700;color:var(--gold);
}
.upg-cost.cant-afford{color:var(--red)}
.upg-maxed-badge{
  padding:4px 10px;border-radius:20px;font-size:10px;font-family:'Aldrich',monospace;
  background:rgba(245,158,11,.15);color:var(--gold);border:1px solid rgba(245,158,11,.3);
}

/* ============ REFERRALS PAGE ============ */
.ref-hero{
  margin:16px;background:linear-gradient(135deg,rgba(91,138,245,.15),rgba(168,85,247,.15));
  border:1px solid rgba(91,138,245,.25);border-radius:18px;padding:20px;text-align:center;
}
.ref-hero-icon{font-size:48px;margin-bottom:8px}
.ref-hero-title{font-family:'Aldrich',monospace;font-size:18px;color:white;margin-bottom:4px}
.ref-hero-sub{font-size:12px;color:var(--muted)}
.ref-reward-chips{display:flex;gap:8px;justify-content:center;margin-top:12px;flex-wrap:wrap}
.ref-chip{
  padding:6px 14px;border-radius:20px;font-size:11px;font-family:'Aldrich',monospace;
}
.ref-chip.gold{background:rgba(245,158,11,.15);border:1px solid rgba(245,158,11,.3);color:var(--gold)}
.ref-chip.purple{background:rgba(168,85,247,.15);border:1px solid rgba(168,85,247,.3);color:var(--accent2)}

.ref-code-box{
  margin:0 16px 16px;background:var(--card);border:1px solid var(--border);
  border-radius:14px;padding:16px;
}
.ref-code-label{font-size:11px;color:var(--muted);font-family:'Aldrich',monospace;letter-spacing:1px;margin-bottom:8px}
.ref-code-display{
  display:flex;align-items:center;gap:10px;
  background:var(--bg3);border:1px solid var(--border2);border-radius:10px;padding:10px 14px;
}
.ref-code-val{flex:1;font-family:'Aldrich',monospace;font-size:18px;font-weight:700;color:var(--accent);letter-spacing:3px}
.copy-btn{
  padding:7px 14px;background:rgba(91,138,245,.15);border:1px solid rgba(91,138,245,.3);
  color:var(--accent);border-radius:8px;cursor:pointer;font-size:11px;font-family:'Aldrich',monospace;
  transition:all .2s;
}
.copy-btn:hover{background:rgba(91,138,245,.25)}
.copy-btn.copied{background:rgba(16,185,129,.15);border-color:rgba(16,185,129,.3);color:var(--green)}

.ref-input-box{
  margin:0 16px 16px;background:var(--card);border:1px solid var(--border);
  border-radius:14px;padding:16px;
}
.ref-input-row{display:flex;gap:8px;margin-top:8px}
.ref-input{
  flex:1;background:var(--bg3);border:1px solid var(--border2);border-radius:8px;
  padding:10px 14px;color:var(--text);font-family:'Aldrich',monospace;font-size:14px;
  outline:none;letter-spacing:2px;transition:border .2s;
}
.ref-input:focus{border-color:var(--accent)}
.ref-input::placeholder{color:var(--dim);letter-spacing:1px}
.ref-submit{
  padding:10px 18px;background:rgba(91,138,245,.2);border:1px solid rgba(91,138,245,.4);
  color:var(--accent);border-radius:8px;cursor:pointer;font-size:12px;font-family:'Aldrich',monospace;
  transition:all .2s;white-space:nowrap;
}
.ref-submit:hover{background:rgba(91,138,245,.35)}

.ref-friends{margin:0 16px}
.ref-friends-title{font-size:12px;color:var(--muted);font-family:'Aldrich',monospace;letter-spacing:1px;margin-bottom:10px}
.ref-friend-item{
  display:flex;align-items:center;gap:12px;padding:12px 14px;
  background:var(--card);border:1px solid var(--border);border-radius:12px;margin-bottom:8px;
}
.ref-friend-av{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.ref-friend-name{font-size:13px;font-weight:600;flex:1}
.ref-friend-bonus{font-family:'Aldrich',monospace;font-size:12px;color:var(--gold)}

/* ============ MISSIONS PAGE ============ */
.mission-item{
  margin:0 16px 10px;background:var(--card);border:1px solid var(--border);
  border-radius:14px;padding:14px 16px;display:flex;align-items:center;gap:12px;
  transition:all .2s;cursor:pointer;
}
.mission-item:hover{border-color:var(--accent)}
.mission-item.completed{border-color:var(--green);background:rgba(16,185,129,.04)}
.mission-icon{font-size:26px;flex-shrink:0}
.mission-info{flex:1}
.mission-name{font-size:14px;font-weight:700;color:white}
.mission-desc{font-size:11px;color:var(--muted);margin-top:2px}
.mission-progress{margin-top:6px;height:4px;background:var(--border);border-radius:2px;overflow:hidden}
.mission-prog-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));border-radius:2px;transition:width .5s}
.mission-reward{text-align:right;flex-shrink:0}
.mission-rew-val{font-family:'Aldrich',monospace;font-size:13px;font-weight:700;color:var(--gold)}
.mission-rew-lbl{font-size:9px;color:var(--muted);margin-top:2px}
.mission-claim-btn{
  padding:5px 12px;background:rgba(16,185,129,.15);border:1px solid rgba(16,185,129,.3);
  color:var(--green);border-radius:8px;font-size:10px;font-family:'Aldrich',monospace;cursor:pointer;margin-top:4px;
  transition:all .2s;
}
.mission-claim-btn:hover{background:rgba(16,185,129,.3)}
.mission-claimed{font-size:10px;color:var(--green);font-family:'Aldrich',monospace}

.mission-section-title{
  padding:16px 20px 8px;font-size:11px;color:var(--muted);
  font-family:'Aldrich',monospace;letter-spacing:2px;
}

/* ============ STATS PAGE ============ */
.stats-grid{padding:16px;display:grid;grid-template-columns:1fr 1fr;gap:10px}
.stats-card{
  background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px;
}
.stats-card.wide{grid-column:span 2}
.stats-card-icon{font-size:24px;margin-bottom:8px}
.stats-card-val{font-family:'Aldrich',monospace;font-size:22px;font-weight:700;color:white}
.stats-card-lbl{font-size:11px;color:var(--muted);margin-top:4px}
.league-progress{margin:16px}
.league-grid{display:flex;flex-direction:column;gap:8px}
.league-item{
  display:flex;align-items:center;gap:12px;padding:12px 14px;
  background:var(--card);border:1px solid var(--border);border-radius:12px;
}
.league-item.current{border-color:var(--accent);background:rgba(91,138,245,.07)}
.league-emoji{font-size:22px}
.league-name{font-size:13px;font-weight:700;flex:1}
.league-req{font-size:11px;color:var(--muted);font-family:'Aldrich',monospace}
.league-check{font-size:16px}

/* ============ DAILY BONUS ============ */
.daily-modal{
  position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:1000;
  display:flex;align-items:flex-end;justify-content:center;
  backdrop-filter:blur(4px);
}
.daily-modal.hidden{display:none}
.daily-panel{
  background:var(--bg3);border:1px solid var(--border2);border-radius:24px 24px 0 0;
  padding:28px 20px 40px;width:100%;max-width:430px;
  animation:slideUp .3s ease;
}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.daily-title{font-family:'Aldrich',monospace;font-size:20px;color:white;text-align:center;margin-bottom:4px}
.daily-sub{font-size:13px;color:var(--muted);text-align:center;margin-bottom:20px}
.daily-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:20px}
.daily-day{
  background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px 6px;
  text-align:center;position:relative;
}
.daily-day.claimed{background:rgba(16,185,129,.1);border-color:rgba(16,185,129,.3)}
.daily-day.today{background:rgba(91,138,245,.12);border-color:var(--accent);box-shadow:0 0 12px rgba(91,138,245,.2)}
.daily-day.future{opacity:.4}
.daily-day-num{font-size:9px;color:var(--muted);font-family:'Aldrich',monospace;letter-spacing:.5px}
.daily-day-icon{font-size:20px;margin:4px 0}
.daily-day-val{font-size:10px;font-family:'Aldrich',monospace;color:var(--gold);font-weight:700}
.daily-day.claimed .daily-day-icon::after{content:'‚úì';position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(16,185,129,.5);border-radius:10px;font-size:16px}
.daily-claim-btn{
  width:100%;padding:14px;background:linear-gradient(90deg,var(--accent),var(--accent2));
  border:none;border-radius:14px;font-family:'Aldrich',monospace;font-size:15px;font-weight:700;
  color:white;cursor:pointer;letter-spacing:1px;
  box-shadow:0 4px 20px rgba(91,138,245,.4);transition:all .2s;
}
.daily-claim-btn:hover{transform:translateY(-1px);box-shadow:0 6px 25px rgba(91,138,245,.6)}
.daily-claim-btn:disabled{opacity:.5;cursor:default;transform:none}

/* TOAST */
.toast{
  position:fixed;top:80px;left:50%;transform:translateX(-50%) translateY(-20px);
  background:var(--card2);border:1px solid var(--accent);border-radius:12px;
  padding:10px 20px;font-family:'Aldrich',monospace;font-size:13px;color:white;
  z-index:2000;opacity:0;transition:all .3s;pointer-events:none;white-space:nowrap;
  box-shadow:0 4px 20px rgba(91,138,245,.3);
}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* MULTIPLIER BADGE */
.mult-badge{
  position:fixed;top:58px;right:10px;z-index:50;
  padding:4px 10px;border-radius:20px;font-family:'Aldrich',monospace;font-size:12px;
  background:rgba(245,158,11,.15);border:1px solid rgba(245,158,11,.4);color:var(--gold);
  display:none;animation:badgePop .3s ease;
}
@keyframes badgePop{from{transform:scale(.5)}to{transform:scale(1)}}
.mult-badge.visible{display:block}

/* PARTICLE */
.particle{
  position:fixed;pointer-events:none;z-index:98;border-radius:50%;
  animation:particleFly .8s ease forwards;
}
@keyframes particleFly{
  0%{opacity:1;transform:translate(0,0) scale(1)}
  100%{opacity:0;transform:translate(var(--tx),var(--ty)) scale(0)}
}

/* LEVEL UP ANIMATION */
.level-up-anim{
  position:fixed;inset:0;z-index:500;pointer-events:none;
  display:flex;align-items:center;justify-content:center;
  animation:levelUpFade 1.5s ease forwards;
}
@keyframes levelUpFade{
  0%{opacity:0}20%{opacity:1}70%{opacity:1}100%{opacity:0}
}
.level-up-text{
  font-family:'Aldrich',monospace;font-size:40px;color:var(--gold);
  text-shadow:0 0 30px var(--gold),0 0 60px rgba(245,158,11,.5);
  animation:levelUpScale 1.5s ease forwards;
}
@keyframes levelUpScale{
  0%{transform:scale(.5)}30%{transform:scale(1.2)}50%{transform:scale(1)}70%{transform:scale(1)}100%{transform:scale(1.5)}
}

/* RESPONSIVE */
@media (min-height: 700px) {
  .orb{width:200px;height:200px}
  .orb-ring-1{width:300px;height:300px}
  .orb-ring-2{width:260px;height:260px}
  .orb-ring-3{width:340px;height:340px}
}
</style>
</head>
<body>

<div class="toast" id="toast"></div>
<div class="mult-badge" id="multBadge"></div>

<!-- DAILY BONUS MODAL -->
<div class="daily-modal hidden" id="dailyModal">
  <div class="daily-panel">
    <div style="text-align:center;margin-bottom:8px;font-size:32px">üéÅ</div>
    <div class="daily-title">–ï–ñ–ï–î–ù–ï–í–ù–´–ô –ë–û–ù–£–°</div>
    <div class="daily-sub">–ó–∞—Ö–æ–¥–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∏ –ø–æ–ª—É—á–∞–π –Ω–∞–≥—Ä–∞–¥—ã!</div>
    <div class="daily-grid" id="dailyGrid"></div>
    <button class="daily-claim-btn" id="dailyClaimBtn" onclick="claimDaily()">–ó–ê–ë–†–ê–¢–¨ –ù–ê–ì–†–ê–î–£</button>
  </div>
</div>

<div class="app">
  <!-- TOP BAR -->
  <div class="topbar">
    <div class="tb-avatar" id="tbAvatar">‚ö°</div>
    <div class="tb-info">
      <div class="tb-name" id="tbName">–ò–ì–†–û–ö</div>
      <div class="tb-league" id="tbLeague">üîµ –ë–†–û–ù–ó–ê</div>
    </div>
    <div class="tb-coins">
      <span class="coin-icon">üíé</span>
      <span id="tbCoins">0</span>
    </div>
  </div>

  <div class="pages">

    <!-- ======== TAP PAGE ======== -->
    <div class="page active" id="page-tap">
      <div class="tap-page">

        <div class="rank-banner">
          <div class="rank-icon" id="rankIcon">üîµ</div>
          <div class="rank-info">
            <div style="display:flex;justify-content:space-between">
              <div class="rank-name" id="rankName">–ë–†–û–ù–ó–ê</div>
              <div class="rank-next" id="rankNext">‚Üí –°–ï–†–ï–ë–†–û</div>
            </div>
            <div class="rank-progress-wrap">
              <div class="rank-bar"><div class="rank-fill" id="rankFill" style="width:0%"></div></div>
              <div class="rank-label" id="rankLabel">0 / 10,000 üíé</div>
            </div>
          </div>
        </div>

        <div class="orb-container">
          <div class="orb-rings">
            <div class="orb-ring orb-ring-3"></div>
            <div class="orb-ring orb-ring-1"></div>
            <div class="orb-ring orb-ring-2"></div>
          </div>
          <div class="orb" id="mainOrb" ontouchstart="handleTap(event)" onmousedown="handleTap(event)"></div>
        </div>

        <div class="energy-section">
          <div class="energy-top">
            <div class="energy-label">‚ö° –≠–ù–ï–†–ì–ò–Ø</div>
            <div class="energy-val" id="energyVal" style="color:var(--accent3)">1000 / 1000</div>
          </div>
          <div class="energy-bar-wrap">
            <div class="energy-bar" id="energyBar" style="width:100%"></div>
          </div>
        </div>

        <div class="boosts-row">
          <div class="boost-card" id="boostTurbo" onclick="activateBoost('turbo')">
            <div class="boost-icon">üî•</div>
            <div class="boost-name">–¢–£–†–ë–û</div>
            <div class="boost-cd" id="turboCd">x3 TAP</div>
            <div class="boost-uses" id="turboUses">3</div>
          </div>
          <div class="boost-card" id="boostRefill" onclick="activateBoost('refill')">
            <div class="boost-icon">‚ö°</div>
            <div class="boost-name">–ó–ê–ü–†–ê–í–ö–ê</div>
            <div class="boost-cd" id="refillCd">–ú–ê–ö–°</div>
            <div class="boost-uses" id="refillUses">3</div>
          </div>
          <div class="boost-card" id="boostX5" onclick="activateBoost('x5')">
            <div class="boost-icon">üí•</div>
            <div class="boost-name">√ó5 –¢–ê–ü</div>
            <div class="boost-cd" id="x5Cd">60 –°–ï–ö</div>
            <div class="boost-uses" id="x5Uses">1</div>
          </div>
          <div class="boost-card" id="boostAuto" onclick="activateBoost('auto')">
            <div class="boost-icon">ü§ñ</div>
            <div class="boost-name">–ê–í–¢–û–¢–ê–ü</div>
            <div class="boost-cd" id="autoCd">30 –°–ï–ö</div>
            <div class="boost-uses" id="autoUses">2</div>
          </div>
        </div>

        <div class="stats-strip">
          <div class="stat-chip">
            <div class="stat-chip-val" id="tapPowerDisp">+1</div>
            <div class="stat-chip-lbl">–ó–ê –¢–ê–ü</div>
          </div>
          <div class="stat-chip">
            <div class="stat-chip-val" id="totalTapsDisp">0</div>
            <div class="stat-chip-lbl">–¢–ê–ü–û–í</div>
          </div>
          <div class="stat-chip">
            <div class="stat-chip-val" id="passiveDisp">+0/—Å</div>
            <div class="stat-chip-lbl">–ü–ê–°–°–ò–í</div>
          </div>
          <div class="stat-chip">
            <div class="stat-chip-val" id="streakDisp">0</div>
            <div class="stat-chip-lbl">–°–ï–†–ò–Ø</div>
          </div>
        </div>

      </div>
    </div>

    <!-- ======== UPGRADES PAGE ======== -->
    <div class="page" id="page-upgrades">
      <div class="page-header">
        <div class="page-title">‚ö° –£–õ–£–ß–®–ï–ù–ò–Ø</div>
        <div class="page-sub" id="upgBalance">–ë–∞–ª–∞–Ω—Å: 0 üíé</div>
      </div>
      <div class="upg-tabs" id="upgTabs">
        <div class="upg-tab active" onclick="switchUpgTab('tap',this)">–¢–ê–ü–´</div>
        <div class="upg-tab" onclick="switchUpgTab('energy',this)">–≠–ù–ï–†–ì–ò–Ø</div>
        <div class="upg-tab" onclick="switchUpgTab('passive',this)">–ü–ê–°–°–ò–í</div>
        <div class="upg-tab" onclick="switchUpgTab('special',this)">–°–ü–ï–¶</div>
      </div>
      <div class="upg-grid" id="upgGrid"></div>
    </div>

    <!-- ======== REFERRALS PAGE ======== -->
    <div class="page" id="page-ref">
      <div class="page-header">
        <div class="page-title">üë• –†–ï–§–ï–†–ê–õ–´</div>
        <div class="page-sub">–ó–æ–≤–∏ –¥—Ä—É–∑–µ–π ‚Äî –ø–æ–ª—É—á–∞–π –±–æ–Ω—É—Å—ã</div>
      </div>

      <div class="ref-hero">
        <div class="ref-hero-icon">ü§ù</div>
        <div class="ref-hero-title">–ü–†–ò–ì–õ–ê–°–ò –î–†–£–ì–ê</div>
        <div class="ref-hero-sub">–¢—ã –ø–æ–ª—É—á–∞–µ—à—å –±–æ–Ω—É—Å –∑–∞ –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞</div>
        <div class="ref-reward-chips">
          <div class="ref-chip gold">+5,000 üíé –∑–∞ –¥—Ä—É–≥–∞</div>
          <div class="ref-chip purple">+10% –æ—Ç –º–æ–Ω–µ—Ç –¥—Ä—É–≥–∞</div>
          <div class="ref-chip gold">+2√ó —ç–Ω–µ—Ä–≥–∏—è –Ω–∞ 24—á</div>
        </div>
      </div>

      <div class="ref-code-box">
        <div class="ref-code-label">–¢–í–û–ô –ö–û–î</div>
        <div class="ref-code-display">
          <div class="ref-code-val" id="myRefCode">VOID-0000</div>
          <div class="copy-btn" id="copyBtn" onclick="copyRefCode()">–ö–û–ü–ò–†–û–í–ê–¢–¨</div>
        </div>
        <div style="margin-top:10px;font-size:11px;color:var(--muted)">
          <span id="refCount">0</span> –¥—Ä—É–∑–µ–π —É–∂–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å
        </div>
      </div>

      <div class="ref-input-box">
        <div class="ref-code-label">–í–í–ï–°–¢–ò –ß–£–ñ–û–ô –ö–û–î</div>
        <div style="font-size:12px;color:var(--muted);margin-bottom:4px">–ü–æ–ª—É—á–∏ –±–æ–Ω—É—Å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –ø–æ –∫–æ–¥—É</div>
        <div class="ref-input-row">
          <input class="ref-input" id="refCodeInput" placeholder="VOID-XXXX" maxlength="9">
          <div class="ref-submit" onclick="submitRefCode()">–ü–†–ò–ú–ï–ù–ò–¢–¨</div>
        </div>
      </div>

      <div class="ref-friends">
        <div class="ref-friends-title">–¢–í–û–ò –†–ï–§–ï–†–ê–õ–´ (<span id="refFriendsCount">0</span>)</div>
        <div id="refFriendsList"></div>
        <div id="refEmptyState" style="text-align:center;padding:30px;color:var(--muted);font-size:13px">
          –ü–æ–∫–∞ –Ω–∏–∫–æ–≥–æ –Ω–µ—Ç. –ü–æ–¥–µ–ª–∏—Å—å –∫–æ–¥–æ–º!
        </div>
      </div>
    </div>

    <!-- ======== MISSIONS PAGE ======== -->
    <div class="page" id="page-missions">
      <div class="page-header">
        <div class="page-title">üéØ –ú–ò–°–°–ò–ò</div>
        <div class="page-sub" id="missionsComplete">0 / 0 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
      </div>
      <div id="missionsList"></div>
    </div>

    <!-- ======== STATS PAGE ======== -->
    <div class="page" id="page-stats">
      <div class="page-header">
        <div class="page-title">üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
        <div class="page-sub">–¢–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</div>
      </div>
      <div class="stats-grid">
        <div class="stats-card"><div class="stats-card-icon">üíé</div><div class="stats-card-val" id="st-total">0</div><div class="stats-card-lbl">–í–°–ï–ì–û –ó–ê–†–ê–ë–û–¢–ê–ù–û</div></div>
        <div class="stats-card"><div class="stats-card-icon">üëÜ</div><div class="stats-card-val" id="st-taps">0</div><div class="stats-card-lbl">–í–°–ï–ì–û –¢–ê–ü–û–í</div></div>
        <div class="stats-card"><div class="stats-card-icon">üî•</div><div class="stats-card-val" id="st-streak">0</div><div class="stats-card-lbl">–°–ï–†–ò–Ø –î–ù–ï–ô</div></div>
        <div class="stats-card"><div class="stats-card-icon">‚ö°</div><div class="stats-card-val" id="st-tap-power">0</div><div class="stats-card-lbl">–°–ò–õ–ê –¢–ê–ü–ê</div></div>
        <div class="stats-card wide"><div class="stats-card-icon">üèÜ</div><div class="stats-card-val" id="st-league">–ë–†–û–ù–ó–ê</div><div class="stats-card-lbl">–¢–ï–ö–£–©–ê–Ø –õ–ò–ì–ê</div></div>
      </div>

      <div class="league-progress">
        <div style="font-size:11px;color:var(--muted);font-family:'Aldrich',monospace;letter-spacing:2px;margin-bottom:10px;padding:0 4px">–õ–ò–ì–ò</div>
        <div class="league-grid" id="leagueGrid"></div>
      </div>
    </div>

  </div>

  <!-- BOTTOM NAV -->
  <div class="bottomnav">
    <div class="nav-btn active" onclick="showPage('tap',this)">
      <div class="nav-icon">‚ú¶</div>
      <div class="nav-label">–¢–ê–ü</div>
    </div>
    <div class="nav-btn" onclick="showPage('upgrades',this)">
      <div class="nav-icon">‚ö°</div>
      <div class="nav-label">–ü–†–û–ö–ê–ß–ö–ê</div>
    </div>
    <div class="nav-btn" onclick="showPage('missions',this)">
      <div class="nav-icon">üéØ</div>
      <div class="nav-label">–ú–ò–°–°–ò–ò</div>
      <div class="nav-badge" id="missionsBadge" style="display:none">!</div>
    </div>
    <div class="nav-btn" onclick="showPage('ref',this)">
      <div class="nav-icon">üë•</div>
      <div class="nav-label">–†–ï–§–ï–†–ê–õ–´</div>
    </div>
    <div class="nav-btn" onclick="showPage('stats',this)">
      <div class="nav-icon">üìä</div>
      <div class="nav-label">–°–¢–ê–¢–´</div>
    </div>
  </div>
</div>

<script>
// ============ STATE ============
const DEFAULT_STATE = {
  coins: 0, totalCoins: 0, totalTaps: 0,
  energy: 1000, maxEnergy: 1000, tapPower: 1,
  passiveIncome: 0, streak: 0, lastLogin: null,
  dailyDay: 0, lastDailyClaim: null,
  refCode: 'VOID-' + Math.random().toString(36).slice(2,6).toUpperCase(),
  refUsed: false, refriends: [], refCount: 0,
  upgrades: {}, boosts: { turbo:3, refill:3, x5:1, auto:2 },
  activeBoosts: {}, claimedMissions: [],
  league: 0
};
let S = JSON.parse(localStorage.getItem('voidcore') || 'null') || {...DEFAULT_STATE};

// ============ LEAGUES ============
const LEAGUES = [
  {name:'–ë–†–û–ù–ó–ê',icon:'üîµ',req:0,color:'#5b8af5'},
  {name:'–°–ï–†–ï–ë–†–û',icon:'‚ö™',req:10000,color:'#c0c0c0'},
  {name:'–ó–û–õ–û–¢–û',icon:'üü°',req:100000,color:'#f59e0b'},
  {name:'–ü–õ–ê–¢–ò–ù–ê',icon:'üí†',req:1000000,color:'#22d3ee'},
  {name:'–î–ò–ê–ú–ê–ù–¢',icon:'üíé',req:10000000,color:'#a855f7'},
  {name:'–ú–ê–°–¢–ï–†',icon:'üîÆ',req:100000000,color:'#ec4899'},
  {name:'–ì–†–ê–ù–î',icon:'üëë',req:1000000000,color:'#fbbf24'}
];

// ============ UPGRADES DATA ============
const UPGRADES = {
  tap: [
    {id:'tap1',name:'–£—Å–∏–ª–µ–Ω–Ω—ã–π —Ç–∞–ø',desc:'+1 üíé –∑–∞ —Ç–∞–ø',icon:'üëÜ',baseCost:100,costMult:1.8,maxLvl:50,effect:'tapPower',val:1,color:'var(--accent)'},
    {id:'tap2',name:'–î–≤–æ–π–Ω–æ–π —É–¥–∞—Ä',desc:'–®–∞–Ω—Å 20% –Ω–∞ x2 —Ç–∞–ø',icon:'‚úåÔ∏è',baseCost:500,costMult:2.0,maxLvl:20,effect:'doubleTap',val:0,color:'var(--accent2)'},
    {id:'tap3',name:'–ö—Ä–∏—Ç-—É–¥–∞—Ä',desc:'+5 üíé –∑–∞ —Ç–∞–ø',icon:'üí•',baseCost:2000,costMult:2.2,maxLvl:30,effect:'tapPower',val:5,color:'var(--red)'},
    {id:'tap4',name:'–ö–≤–∞–Ω—Ç–æ–≤—ã–π —Ç–∞–ø',desc:'+20 üíé –∑–∞ —Ç–∞–ø',icon:'‚öõÔ∏è',baseCost:10000,costMult:2.5,maxLvl:20,effect:'tapPower',val:20,color:'var(--accent3)'},
    {id:'tap5',name:'–ì–∏–ø–µ—Ä—É–¥–∞—Ä',desc:'+100 üíé –∑–∞ —Ç–∞–ø',icon:'üåÄ',baseCost:100000,costMult:3.0,maxLvl:10,effect:'tapPower',val:100,color:'#ec4899'},
    {id:'tap6',name:'–ù–µ–π—Ä–æ-—Ç–∞–ø',desc:'+500 üíé –∑–∞ —Ç–∞–ø',icon:'üß†',baseCost:1000000,costMult:3.5,maxLvl:5,effect:'tapPower',val:500,color:'var(--gold)'},
  ],
  energy: [
    {id:'en1',name:'–≠–Ω–µ—Ä–≥–æ-–±–∞–∫',desc:'+500 –∫ –º–∞–∫—Å. —ç–Ω–µ—Ä–≥–∏–∏',icon:'üîã',baseCost:200,costMult:1.7,maxLvl:20,effect:'maxEnergy',val:500,color:'var(--accent3)'},
    {id:'en2',name:'–ë—ã—Å—Ç—Ä–∞—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è',desc:'+1 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫',icon:'‚ö°',baseCost:1000,costMult:2.0,maxLvl:15,effect:'regenSpeed',val:1,color:'var(--green)'},
    {id:'en3',name:'–°—É–ø–µ—Ä–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä',desc:'+2000 –∫ –º–∞–∫—Å. —ç–Ω–µ—Ä–≥–∏–∏',icon:'üè≠',baseCost:5000,costMult:2.3,maxLvl:10,effect:'maxEnergy',val:2000,color:'var(--accent2)'},
    {id:'en4',name:'–Ø–¥–µ—Ä–Ω–∞—è –±–∞—Ç–∞—Ä–µ—è',desc:'+5 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫',icon:'‚ò¢Ô∏è',baseCost:50000,costMult:2.8,maxLvl:8,effect:'regenSpeed',val:5,color:'var(--red)'},
    {id:'en5',name:'–¢—ë–º–Ω–∞—è –º–∞—Ç–µ—Ä–∏—è',desc:'+10,000 –∫ –º–∞–∫—Å. —ç–Ω–µ—Ä–≥–∏–∏',icon:'üåë',baseCost:500000,costMult:3.2,maxLvl:5,effect:'maxEnergy',val:10000,color:'#6366f1'},
  ],
  passive: [
    {id:'ps1',name:'–ê–≤—Ç–æ-–º–∞–π–Ω–µ—Ä',desc:'+1 üíé/—Å–µ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏',icon:'‚õèÔ∏è',baseCost:500,costMult:1.9,maxLvl:50,effect:'passive',val:1,color:'var(--gold)'},
    {id:'ps2',name:'–ù–∞–Ω–æ-–±–æ—Ç—ã',desc:'+5 üíé/—Å–µ–∫ –ø–∞—Å—Å–∏–≤–Ω–æ',icon:'ü§ñ',baseCost:3000,costMult:2.1,maxLvl:30,effect:'passive',val:5,color:'var(--accent2)'},
    {id:'ps3',name:'–ö—Ä–∏—Å—Ç–∞–ª–ª-—Ñ–µ—Ä–º–∞',desc:'+20 üíé/—Å–µ–∫ –ø–∞—Å—Å–∏–≤–Ω–æ',icon:'üíé',baseCost:20000,costMult:2.4,maxLvl:20,effect:'passive',val:20,color:'var(--accent3)'},
    {id:'ps4',name:'–ö–≤–∞–Ω—Ç–æ–≤—ã–π –∑–∞–≤–æ–¥',desc:'+100 üíé/—Å–µ–∫ –ø–∞—Å—Å–∏–≤–Ω–æ',icon:'üèóÔ∏è',baseCost:200000,costMult:2.8,maxLvl:10,effect:'passive',val:100,color:'var(--red)'},
    {id:'ps5',name:'–ß—ë—Ä–Ω–∞—è –¥—ã—Ä–∞',desc:'+1000 üíé/—Å–µ–∫ –ø–∞—Å—Å–∏–≤–Ω–æ',icon:'üï≥Ô∏è',baseCost:5000000,costMult:3.5,maxLvl:5,effect:'passive',val:1000,color:'#6366f1'},
  ],
  special: [
    {id:'sp1',name:'–†–µ—Ñ–µ—Ä–∞–ª-–±—É—Å—Ç',desc:'–î—Ä—É–∑—å—è –¥–∞—é—Ç +15% –º–æ–Ω–µ—Ç',icon:'ü§ù',baseCost:5000,costMult:2.5,maxLvl:5,effect:'refBonus',val:0.05,color:'var(--accent)'},
    {id:'sp2',name:'–ë–æ–Ω—É—Å —Å–µ—Ä–∏–∏',desc:'+5% –∑–∞ –¥–µ–Ω—å —Å–µ—Ä–∏–∏',icon:'üî•',baseCost:10000,costMult:3.0,maxLvl:10,effect:'streakBonus',val:0.05,color:'var(--red)'},
    {id:'sp3',name:'–£–¥–∞—á–∞',desc:'–®–∞–Ω—Å –¥—Ä–æ–ø x10 –∫—Ä–∏—Ç',icon:'üçÄ',baseCost:25000,costMult:2.8,maxLvl:8,effect:'luck',val:0.01,color:'var(--green)'},
    {id:'sp4',name:'–ë—É—Å—Ç-–∑–∞—Ä—è–¥—ã',desc:'+1 –∑–∞—Ä—è–¥ —Ç—É—Ä–±–æ',icon:'‚ö°',baseCost:50000,costMult:4.0,maxLvl:5,effect:'boostCharges',val:1,color:'var(--gold)'},
  ]
};

// ============ MISSIONS DATA ============
const MISSIONS = [
  {id:'m1',name:'–ü–µ—Ä–≤—ã–π —Ç–∞–ø',desc:'–ù–∞–∂–º–∏ 1 —Ä–∞–∑',icon:'üëÜ',category:'–ù–∞—á–∞–ª–æ',req:1,type:'taps',reward:100},
  {id:'m2',name:'–†–∞–∑–º–∏–Ω–∫–∞',desc:'–ù–∞–∂–º–∏ 100 —Ä–∞–∑',icon:'üí™',category:'–ù–∞—á–∞–ª–æ',req:100,type:'taps',reward:500},
  {id:'m3',name:'–ú–∞—à–∏–Ω–∞ —Ç–∞–ø–æ–≤',desc:'–ù–∞–∂–º–∏ 1,000 —Ä–∞–∑',icon:'ü§ñ',category:'–¢–∞–ø—ã',req:1000,type:'taps',reward:2000},
  {id:'m4',name:'–¢–∞–ø-–º–æ–Ω—Å—Ç—Ä',desc:'–ù–∞–∂–º–∏ 10,000 —Ä–∞–∑',icon:'üëπ',category:'–¢–∞–ø—ã',req:10000,type:'taps',reward:10000},
  {id:'m5',name:'–õ–µ–≥–µ–Ω–¥–∞ —Ç–∞–ø–æ–≤',desc:'–ù–∞–∂–º–∏ 100,000 —Ä–∞–∑',icon:'üèÜ',category:'–¢–∞–ø—ã',req:100000,type:'taps',reward:100000},
  {id:'m6',name:'–ü–µ—Ä–≤—ã–µ –º–æ–Ω–µ—Ç—ã',desc:'–ù–∞–∫–æ–ø–∏ 1,000 üíé',icon:'üí∞',category:'–ú–æ–Ω–µ—Ç—ã',req:1000,type:'total',reward:500},
  {id:'m7',name:'–ë–æ–≥–∞—á',desc:'–ù–∞–∫–æ–ø–∏ 100,000 üíé',icon:'üíé',category:'–ú–æ–Ω–µ—Ç—ã',req:100000,type:'total',reward:10000},
  {id:'m8',name:'–ú–∏–ª–ª–∏–æ–Ω–µ—Ä',desc:'–ù–∞–∫–æ–ø–∏ 1,000,000 üíé',icon:'üåü',category:'–ú–æ–Ω–µ—Ç—ã',req:1000000,type:'total',reward:100000},
  {id:'m9',name:'–°–µ—Ä–∏—è –Ω–∞—á–∞—Ç–∞',desc:'–ó–∞—Ö–æ–¥–∏ 3 –¥–Ω—è –ø–æ–¥—Ä—è–¥',icon:'üìÖ',category:'–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',req:3,type:'streak',reward:3000},
  {id:'m10',name:'–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∏–≥—Ä–æ–∫',desc:'–ó–∞—Ö–æ–¥–∏ 7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥',icon:'üî•',category:'–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',req:7,type:'streak',reward:15000},
  {id:'m11',name:'–°–æ—Ü–∏–∞–ª—å–Ω—ã–π',desc:'–ü—Ä–∏–≥–ª–∞—Å–∏ 1 –¥—Ä—É–≥–∞',icon:'üë•',category:'–†–µ—Ñ–µ—Ä–∞–ª—ã',req:1,type:'refs',reward:5000},
  {id:'m12',name:'–ê–º–±–∞—Å—Å–∞–¥–æ—Ä',desc:'–ü—Ä–∏–≥–ª–∞—Å–∏ 5 –¥—Ä—É–∑–µ–π',icon:'üåê',category:'–†–µ—Ñ–µ—Ä–∞–ª—ã',req:5,type:'refs',reward:50000},
  {id:'m13',name:'–ê–ø–≥—Ä–µ–π–¥–µ—Ä',desc:'–ö—É–ø–∏ 1 —É–ª—É—á—à–µ–Ω–∏–µ',icon:'‚¨ÜÔ∏è',category:'–£–ª—É—á—à–µ–Ω–∏—è',req:1,type:'upgrades',reward:500},
  {id:'m14',name:'–ò–Ω–≤–µ—Å—Ç–æ—Ä',desc:'–ö—É–ø–∏ 10 —É–ª—É—á—à–µ–Ω–∏–π',icon:'üìà',category:'–£–ª—É—á—à–µ–Ω–∏—è',req:10,type:'upgrades',reward:5000},
];

// ============ DAILY REWARDS ============
const DAILY_REWARDS = [
  {icon:'üíé',val:500,label:'500'},
  {icon:'‚ö°',val:0,label:'2√ó –≠–ù–ï–†–ì',special:'energy2x'},
  {icon:'üíé',val:2000,label:'2,000'},
  {icon:'üî•',val:0,label:'–¢–£–†–ë–û√ó3',special:'turbo3'},
  {icon:'üíé',val:5000,label:'5,000'},
  {icon:'üíé',val:10000,label:'10,000'},
  {icon:'üëë',val:50000,label:'50,000'},
  {icon:'üåü',val:0,label:'√ó10 –¢–ê–ü',special:'tap10'}
];

// ============ INIT ============
let currentUpgTab = 'tap';
let autoTapInterval = null;
let turboActive = false, x5Active = false, turboTimer = null, x5Timer = null;
let totalUpgradesBought = 0;
let regenInterval = null;

function init() {
  // Streak
  const today = new Date().toDateString();
  if (S.lastLogin !== today) {
    const yesterday = new Date(Date.now() - 86400000).toDateString();
    if (S.lastLogin === yesterday) S.streak++;
    else if (S.lastLogin !== today) S.streak = S.lastLogin ? S.streak : 1;
    S.lastLogin = today;
  }

  recalcStats();
  renderAll();
  startRegen();
  startPassive();
  setupDaily();

  // Check daily bonus
  if (S.lastDailyClaim !== today) {
    setTimeout(() => document.getElementById('dailyModal').classList.remove('hidden'), 1000);
  }
}

function recalcStats() {
  // Recalculate tapPower, maxEnergy, passive from upgrades
  let tapPower = 1, maxEnergy = 1000, passive = 0, regenSpeed = 1;
  for (const cat of Object.values(UPGRADES)) {
    for (const upg of cat) {
      const lvl = S.upgrades[upg.id] || 0;
      if (lvl === 0) continue;
      if (upg.effect === 'tapPower') tapPower += upg.val * lvl;
      if (upg.effect === 'maxEnergy') maxEnergy += upg.val * lvl;
      if (upg.effect === 'passive') passive += upg.val * lvl;
      if (upg.effect === 'regenSpeed') regenSpeed += upg.val * lvl;
    }
  }
  S.tapPower = tapPower;
  S.maxEnergy = maxEnergy;
  S.passiveIncome = passive;
  S.regenSpeed = regenSpeed || 1;
  if (S.energy > S.maxEnergy) S.energy = S.maxEnergy;
}

function save() { localStorage.setItem('voidcore', JSON.stringify(S)); }

// ============ TAP HANDLER ============
function handleTap(e) {
  e.preventDefault();
  const touches = e.touches ? e.touches : [e];
  for (let t of touches) {
    processTap(t.clientX || t.pageX, t.clientY || t.pageY);
  }
}

function processTap(x, y) {
  if (S.energy <= 0) { showToast('‚ö° –ù–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏! –ñ–¥–∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.'); return; }

  let power = S.tapPower;
  if (turboActive) power *= 3;
  if (x5Active) power *= 5;

  // Luck/crit check
  const luckLvl = S.upgrades['sp3'] || 0;
  if (Math.random() < luckLvl * 0.01) power *= 10;

  // Double tap check
  const dblLvl = S.upgrades['tap2'] || 0;
  if (Math.random() < dblLvl * 0.2 / Math.max(1, dblLvl)) power *= 2;

  const energyCost = 1;
  S.energy = Math.max(0, S.energy - energyCost);
  S.coins += power;
  S.totalCoins += power;
  S.totalTaps++;

  spawnFloat(x, y, '+' + formatNum(power), power >= S.tapPower * 5 ? '#f59e0b' : (turboActive || x5Active ? '#a855f7' : '#5b8af5'));
  spawnParticles(x, y);
  spawnRipple(x, y);

  updateUI();
  checkLeague();
  checkMissions();
  save();
}

function spawnFloat(x, y, text, color) {
  const el = document.createElement('div');
  el.className = 'float-num';
  el.textContent = text;
  el.style.cssText = `left:${x}px;top:${y-20}px;color:${color};font-size:${text.length > 5 ? '14' : '18'}px`;
  document.body.appendChild(el);
  setTimeout(() => el.remove(), 900);
}

function spawnRipple(x, y) {
  const el = document.createElement('div');
  el.className = 'tap-ripple';
  el.style.cssText = `left:${x}px;top:${y}px;width:60px;height:60px`;
  document.body.appendChild(el);
  setTimeout(() => el.remove(), 500);
}

function spawnParticles(x, y) {
  if (Math.random() > 0.6) return;
  for (let i = 0; i < 4; i++) {
    const el = document.createElement('div');
    el.className = 'particle';
    const colors = ['#5b8af5','#a855f7','#22d3ee','#f59e0b'];
    const size = Math.random() * 5 + 3;
    const tx = (Math.random() - 0.5) * 80;
    const ty = (Math.random() - 0.7) * 80;
    el.style.cssText = `left:${x}px;top:${y}px;width:${size}px;height:${size}px;background:${colors[i]};--tx:${tx}px;--ty:${ty}px`;
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 800);
  }
}

// ============ ENERGY REGEN ============
function startRegen() {
  if (regenInterval) clearInterval(regenInterval);
  regenInterval = setInterval(() => {
    if (S.energy < S.maxEnergy) {
      S.energy = Math.min(S.maxEnergy, S.energy + (S.regenSpeed || 1));
      updateEnergyUI();
      save();
    }
  }, 1000);
}

// ============ PASSIVE INCOME ============
function startPassive() {
  setInterval(() => {
    if (S.passiveIncome > 0) {
      S.coins += S.passiveIncome;
      S.totalCoins += S.passiveIncome;
      checkLeague();
      checkMissions();
      updateCoinsUI();
      save();
    }
  }, 1000);
}

// ============ BOOSTS ============
function activateBoost(type) {
  if (type === 'turbo') {
    const uses = S.boosts.turbo;
    if (uses <= 0) { showToast('–ù–µ—Ç –∑–∞—Ä—è–¥–æ–≤ –¢—É—Ä–±–æ!'); return; }
    if (turboActive) return;
    S.boosts.turbo--;
    turboActive = true;
    document.getElementById('boostTurbo').classList.add('active-boost');
    document.getElementById('multBadge').textContent = 'üî• –¢–£–†–ë–û √ó3';
    document.getElementById('multBadge').classList.add('visible');
    let t = 15;
    turboTimer = setInterval(() => {
      document.getElementById('turboCd').textContent = t + '—Å';
      t--;
      if (t < 0) {
        turboActive = false;
        clearInterval(turboTimer);
        document.getElementById('boostTurbo').classList.remove('active-boost');
        document.getElementById('turboCd').textContent = 'x3 TAP';
        document.getElementById('multBadge').classList.remove('visible');
      }
    }, 1000);
    updateBoostUI();
  } else if (type === 'refill') {
    const uses = S.boosts.refill;
    if (uses <= 0) { showToast('–ù–µ—Ç –∑–∞—Ä—è–¥–æ–≤ –ó–∞–ø—Ä–∞–≤–∫–∏!'); return; }
    S.boosts.refill--;
    S.energy = S.maxEnergy;
    updateEnergyUI();
    updateBoostUI();
    showToast('‚ö° –≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å–ø–æ–ª–Ω–µ–Ω–∞!');
    save();
  } else if (type === 'x5') {
    if (S.boosts.x5 <= 0) { showToast('–ù–µ—Ç –∑–∞—Ä—è–¥–æ–≤ √ó5!'); return; }
    if (x5Active) return;
    S.boosts.x5--;
    x5Active = true;
    document.getElementById('boostX5').classList.add('active-boost');
    document.getElementById('multBadge').textContent = 'üí• √ó5 –¢–ê–ü';
    document.getElementById('multBadge').classList.add('visible');
    let t = 60;
    x5Timer = setInterval(() => {
      document.getElementById('x5Cd').textContent = t + '—Å';
      t--;
      if (t < 0) {
        x5Active = false;
        clearInterval(x5Timer);
        document.getElementById('boostX5').classList.remove('active-boost');
        document.getElementById('x5Cd').textContent = '60 –°–ï–ö';
        document.getElementById('multBadge').classList.remove('visible');
      }
    }, 1000);
    updateBoostUI();
  } else if (type === 'auto') {
    if (S.boosts.auto <= 0) { showToast('–ù–µ—Ç –∑–∞—Ä—è–¥–æ–≤ –ê–≤—Ç–æ—Ç–∞–ø–∞!'); return; }
    S.boosts.auto--;
    document.getElementById('boostAuto').classList.add('active-boost');
    let t = 30;
    const autoCountdown = setInterval(() => {
      document.getElementById('autoCd').textContent = t + '—Å';
      t--;
    }, 1000);
    autoTapInterval = setInterval(() => {
      const orb = document.getElementById('mainOrb');
      const r = orb.getBoundingClientRect();
      const cx = r.left + r.width/2, cy = r.top + r.height/2;
      processTap(cx + (Math.random()-0.5)*40, cy + (Math.random()-0.5)*40);
    }, 200);
    setTimeout(() => {
      clearInterval(autoTapInterval);
      clearInterval(autoCountdown);
      document.getElementById('boostAuto').classList.remove('active-boost');
      document.getElementById('autoCd').textContent = '30 –°–ï–ö';
    }, 30000);
    updateBoostUI();
    save();
  }
}

// ============ UPGRADES ============
function switchUpgTab(tab, el) {
  currentUpgTab = tab;
  document.querySelectorAll('.upg-tab').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  renderUpgrades();
}

function renderUpgrades() {
  const grid = document.getElementById('upgGrid');
  grid.innerHTML = '';
  const list = UPGRADES[currentUpgTab];
  document.getElementById('upgBalance').textContent = '–ë–∞–ª–∞–Ω—Å: ' + formatNum(S.coins) + ' üíé';

  for (const upg of list) {
    const lvl = S.upgrades[upg.id] || 0;
    const isMaxed = lvl >= upg.maxLvl;
    const cost = Math.floor(upg.baseCost * Math.pow(upg.costMult, lvl));
    const cantAfford = S.coins < cost;
    const locked = lvl === 0 && cost > S.totalCoins * 3 && S.totalCoins < upg.baseCost;

    const item = document.createElement('div');
    item.className = 'upg-item' + (isMaxed ? ' maxed' : '') + (locked ? ' locked' : '');
    item.style.setProperty('--item-color', upg.color);

    const dots = Array.from({length: Math.min(upg.maxLvl, 10)}, (_, i) =>
      `<div class="upg-lvl-dot ${i < Math.min(lvl, 10) ? 'filled' : ''}"></div>`).join('');

    item.innerHTML = `
      <div class="upg-icon" style="background:rgba(91,138,245,.1);border-color:${upg.color}22">${upg.icon}</div>
      <div class="upg-info">
        <div class="upg-name">${upg.name}</div>
        <div class="upg-desc">${upg.desc}</div>
        <div class="upg-level">—É—Ä. ${lvl}/${upg.maxLvl} <div class="upg-lvl-dots">${dots}</div></div>
      </div>
      <div class="upg-right">
        ${isMaxed
          ? '<div class="upg-maxed-badge">MAX</div>'
          : `<div class="upg-cost ${cantAfford ? 'cant-afford' : ''}">üíé ${formatNum(cost)}</div>
             <div style="font-size:10px;color:var(--muted);margin-top:4px;font-family:'Aldrich',monospace">–ö–£–ü–ò–¢–¨</div>`
        }
      </div>
    `;

    if (!isMaxed && !locked) {
      item.addEventListener('click', () => buyUpgrade(upg, lvl, cost));
    }

    grid.appendChild(item);
  }
}

function buyUpgrade(upg, lvl, cost) {
  if (S.coins < cost) { showToast('üíé –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!'); return; }
  S.coins -= cost;
  S.upgrades[upg.id] = (S.upgrades[upg.id] || 0) + 1;
  totalUpgradesBought++;
  recalcStats();
  startRegen();
  renderUpgrades();
  updateUI();
  checkMissions();
  save();
  showToast(`‚úÖ ${upg.name} —É–ª—É—á—à–µ–Ω –¥–æ —É—Ä.${S.upgrades[upg.id]}!`);
}

// ============ MISSIONS ============
function getMissionProgress(m) {
  if (m.type === 'taps') return S.totalTaps;
  if (m.type === 'total') return S.totalCoins;
  if (m.type === 'streak') return S.streak;
  if (m.type === 'refs') return S.refCount;
  if (m.type === 'upgrades') return totalUpgradesBought;
  return 0;
}

function renderMissions() {
  const list = document.getElementById('missionsList');
  list.innerHTML = '';
  let complete = 0, total = MISSIONS.length;
  let hasClaim = false;

  const categories = [...new Set(MISSIONS.map(m => m.category))];

  for (const cat of categories) {
    const header = document.createElement('div');
    header.className = 'mission-section-title';
    header.textContent = cat.toUpperCase();
    list.appendChild(header);

    for (const m of MISSIONS.filter(x => x.category === cat)) {
      const prog = getMissionProgress(m);
      const pct = Math.min(100, (prog / m.req) * 100);
      const done = prog >= m.req;
      const claimed = S.claimedMissions.includes(m.id);
      if (claimed) complete++;

      const item = document.createElement('div');
      item.className = 'mission-item' + (claimed ? ' completed' : '');
      item.innerHTML = `
        <div class="mission-icon">${m.icon}</div>
        <div class="mission-info">
          <div class="mission-name">${m.name}</div>
          <div class="mission-desc">${m.desc}</div>
          <div class="mission-progress"><div class="mission-prog-fill" style="width:${pct}%"></div></div>
          <div style="font-size:10px;color:var(--muted);font-family:'Aldrich',monospace;margin-top:3px">${formatNum(Math.min(prog,m.req))} / ${formatNum(m.req)}</div>
        </div>
        <div class="mission-reward">
          <div class="mission-rew-val">üíé ${formatNum(m.reward)}</div>
          <div class="mission-rew-lbl">–ù–ê–ì–†–ê–î–ê</div>
          ${claimed ? '<div class="mission-claimed">‚úì –í–´–î–ê–ù–ê</div>' : done ? `<div class="mission-claim-btn" onclick="claimMission('${m.id}',${m.reward})">–ó–ê–ë–†–ê–¢–¨</div>` : ''}
        </div>
      `;
      list.appendChild(item);

      if (done && !claimed) hasClaim = true;
    }
  }

  document.getElementById('missionsComplete').textContent = `${complete} / ${total} –≤—ã–ø–æ–ª–Ω–µ–Ω–æ`;
  document.getElementById('missionsBadge').style.display = hasClaim ? 'flex' : 'none';
}

function claimMission(id, reward) {
  S.claimedMissions.push(id);
  S.coins += reward;
  S.totalCoins += reward;
  updateUI();
  renderMissions();
  save();
  showToast(`üéâ +${formatNum(reward)} üíé –Ω–∞–≥—Ä–∞–¥–∞ –∑–∞ –º–∏—Å—Å–∏—é!`);
}

function checkMissions() {
  let hasClaim = false;
  for (const m of MISSIONS) {
    if (!S.claimedMissions.includes(m.id) && getMissionProgress(m) >= m.req) {
      hasClaim = true; break;
    }
  }
  document.getElementById('missionsBadge').style.display = hasClaim ? 'flex' : 'none';
}

// ============ REFERRALS ============
function renderReferrals() {
  document.getElementById('myRefCode').textContent = S.refCode;
  document.getElementById('refCount').textContent = S.refCount;
  document.getElementById('refFriendsCount').textContent = S.refriends.length;

  const list = document.getElementById('refFriendsList');
  list.innerHTML = '';
  document.getElementById('refEmptyState').style.display = S.refriends.length ? 'none' : 'block';

  const avatars = ['ü¶ä','üê∫','üêâ','ü¶Ö','üêØ','ü¶Å','ü¶Ñ'];
  for (const f of S.refriends) {
    const item = document.createElement('div');
    item.className = 'ref-friend-item';
    item.innerHTML = `
      <div class="ref-friend-av" style="background:rgba(91,138,245,.15);border:1px solid rgba(91,138,245,.2)">${avatars[Math.floor(Math.random()*avatars.length)]}</div>
      <div class="ref-friend-name">${f.name}</div>
      <div class="ref-friend-bonus">+5,000 üíé</div>
    `;
    list.appendChild(item);
  }
}

function copyRefCode() {
  const code = S.refCode;
  if (navigator.clipboard) navigator.clipboard.writeText(code);
  const btn = document.getElementById('copyBtn');
  btn.textContent = '‚úì –°–ö–û–ü–ò–†–û–í–ê–ù–û';
  btn.classList.add('copied');
  setTimeout(() => { btn.textContent = '–ö–û–ü–ò–†–û–í–ê–¢–¨'; btn.classList.remove('copied'); }, 2000);
}

function submitRefCode() {
  const input = document.getElementById('refCodeInput').value.trim().toUpperCase();
  if (S.refUsed) { showToast('–¢—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥!'); return; }
  if (!input.startsWith('VOID-') || input.length < 8) { showToast('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–¥–∞!'); return; }
  if (input === S.refCode) { showToast('–ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–π –∫–æ–¥!'); return; }

  S.refUsed = true;
  S.coins += 2500;
  S.totalCoins += 2500;
  S.maxEnergy = Math.floor(S.maxEnergy * 1.5);
  document.getElementById('refCodeInput').value = '';
  updateUI();
  save();
  showToast('üéâ –ö–æ–¥ –ø—Ä–∏–º–µ–Ω—ë–Ω! +2,500 üíé –∏ +50% —ç–Ω–µ—Ä–≥–∏–∏!');
}

// SIMULATE adding a referral (for demo)
function addFakeReferral() {
  const names = ['–î—Ä–∞–∫–æ–Ω_777','NightRider','CryptoKing','VoidHunter','StarWalker'];
  const name = names[Math.floor(Math.random() * names.length)] + '_' + Math.floor(Math.random()*999);
  S.refriends.push({name, joined: Date.now()});
  S.refCount++;
  S.coins += 5000;
  S.totalCoins += 5000;
  updateUI();
  renderReferrals();
  save();
  showToast(`üë• ${name} –≤—Å—Ç—É–ø–∏–ª –ø–æ —Ç–≤–æ–µ–π —Å—Å—ã–ª–∫–µ! +5,000 üíé`);
}

// ============ DAILY BONUS ============
function setupDaily() {
  const grid = document.getElementById('dailyGrid');
  grid.innerHTML = '';
  const today = new Date().toDateString();
  const dayIndex = S.dailyDay % DAILY_REWARDS.length;

  for (let i = 0; i < DAILY_REWARDS.length; i++) {
    const r = DAILY_REWARDS[i];
    const claimed = i < S.dailyDay;
    const isToday = i === dayIndex && S.lastDailyClaim !== today;
    const future = i > dayIndex;

    const el = document.createElement('div');
    el.className = 'daily-day' + (claimed ? ' claimed' : '') + (isToday ? ' today' : '') + (future ? ' future' : '');
    el.innerHTML = `
      <div class="daily-day-num">–î–ï–ù–¨ ${i+1}</div>
      <div class="daily-day-icon">${r.icon}</div>
      <div class="daily-day-val">${r.label}</div>
    `;
    grid.appendChild(el);
  }

  const btn = document.getElementById('dailyClaimBtn');
  btn.disabled = S.lastDailyClaim === today;
  btn.textContent = S.lastDailyClaim === today ? '–£–ñ–ï –ó–ê–ë–†–ê–õ –°–ï–ì–û–î–ù–Ø' : '–ó–ê–ë–†–ê–¢–¨ –ù–ê–ì–†–ê–î–£';
}

function claimDaily() {
  const today = new Date().toDateString();
  if (S.lastDailyClaim === today) return;

  const dayIndex = S.dailyDay % DAILY_REWARDS.length;
  const r = DAILY_REWARDS[dayIndex];

  if (r.val > 0) {
    S.coins += r.val;
    S.totalCoins += r.val;
  }
  if (r.special === 'energy2x') { S.maxEnergy *= 2; recalcStats(); }
  if (r.special === 'turbo3') { S.boosts.turbo += 3; }
  if (r.special === 'tap10') { S.tapPower *= 10; setTimeout(() => { recalcStats(); }, 60000); }

  S.dailyDay++;
  S.lastDailyClaim = today;
  S.streak++;
  updateUI();
  save();
  document.getElementById('dailyModal').classList.add('hidden');
  showToast(`üéÅ –î–µ–Ω—å ${dayIndex+1}! ${r.label} –ø–æ–ª—É—á–µ–Ω–æ!`);
}

// ============ LEAGUE ============
function checkLeague() {
  for (let i = LEAGUES.length-1; i >= 0; i--) {
    if (S.totalCoins >= LEAGUES[i].req) {
      if (S.league < i) {
        const was = S.league;
        S.league = i;
        showLevelUp(LEAGUES[i].name);
        save();
      }
      break;
    }
  }
}

function showLevelUp(name) {
  const el = document.createElement('div');
  el.className = 'level-up-anim';
  el.innerHTML = `<div class="level-up-text">üèÜ ${name}!</div>`;
  document.body.appendChild(el);
  setTimeout(() => el.remove(), 1500);
}

function renderLeagueGrid() {
  const grid = document.getElementById('leagueGrid');
  grid.innerHTML = '';
  for (let i = 0; i < LEAGUES.length; i++) {
    const lg = LEAGUES[i];
    const current = i === S.league;
    const done = i < S.league;
    const item = document.createElement('div');
    item.className = 'league-item' + (current ? ' current' : '');
    item.innerHTML = `
      <div class="league-emoji">${lg.icon}</div>
      <div>
        <div class="league-name" style="color:${current ? lg.color : 'inherit'}">${lg.name}</div>
        <div class="league-req">${lg.req === 0 ? '–°—Ç–∞—Ä—Ç' : formatNum(lg.req) + ' üíé'}</div>
      </div>
      <div class="league-check">${done ? '‚úÖ' : current ? '‚ñ∂' : 'üîí'}</div>
    `;
    grid.appendChild(item);
  }
}

// ============ UI UPDATE ============
function updateUI() {
  updateCoinsUI();
  updateEnergyUI();
  updateTapUI();
  updateBoostUI();
}

function updateCoinsUI() {
  document.getElementById('tbCoins').textContent = formatNum(S.coins);
}

function updateEnergyUI() {
  const pct = (S.energy / S.maxEnergy * 100);
  document.getElementById('energyBar').style.width = pct + '%';
  document.getElementById('energyVal').textContent = formatNum(Math.floor(S.energy)) + ' / ' + formatNum(S.maxEnergy);
  const hue = pct > 60 ? 'var(--accent3)' : pct > 30 ? 'var(--gold)' : 'var(--red)';
  document.getElementById('energyVal').style.color = hue;
}

function updateTapUI() {
  document.getElementById('tapPowerDisp').textContent = '+' + formatNum(S.tapPower);
  document.getElementById('totalTapsDisp').textContent = formatNum(S.totalTaps);
  document.getElementById('passiveDisp').textContent = '+' + formatNum(S.passiveIncome) + '/—Å';
  document.getElementById('streakDisp').textContent = S.streak;

  // Rank/League
  const lg = LEAGUES[S.league];
  const nextLg = LEAGUES[S.league + 1];
  document.getElementById('rankIcon').textContent = lg.icon;
  document.getElementById('rankName').textContent = lg.name;
  document.getElementById('tbLeague').textContent = lg.icon + ' ' + lg.name;
  document.getElementById('tbAvatar').style.background = `linear-gradient(135deg, ${lg.color}, ${lg.color}88)`;

  if (nextLg) {
    const pct = Math.min(100, ((S.totalCoins - lg.req) / (nextLg.req - lg.req)) * 100);
    document.getElementById('rankFill').style.width = pct + '%';
    document.getElementById('rankLabel').textContent = formatNum(S.totalCoins - lg.req) + ' / ' + formatNum(nextLg.req - lg.req) + ' üíé';
    document.getElementById('rankNext').textContent = '‚Üí ' + nextLg.name;
  } else {
    document.getElementById('rankFill').style.width = '100%';
    document.getElementById('rankLabel').textContent = '–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –õ–ò–ì–ê!';
    document.getElementById('rankNext').textContent = 'üëë';
  }

  // Stats page
  document.getElementById('st-total').textContent = formatNum(S.totalCoins);
  document.getElementById('st-taps').textContent = formatNum(S.totalTaps);
  document.getElementById('st-streak').textContent = S.streak + ' –¥–Ω.';
  document.getElementById('st-tap-power').textContent = formatNum(S.tapPower);
  document.getElementById('st-league').textContent = lg.icon + ' ' + lg.name;
}

function updateBoostUI() {
  document.getElementById('turboUses').textContent = S.boosts.turbo;
  document.getElementById('refillUses').textContent = S.boosts.refill;
  document.getElementById('x5Uses').textContent = S.boosts.x5;
  document.getElementById('autoUses').textContent = S.boosts.auto;
}

// ============ NAVIGATION ============
function showPage(pageId, navEl) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(n => n.classList.remove('active'));
  document.getElementById('page-' + pageId).classList.add('active');
  if (navEl) navEl.classList.add('active');

  if (pageId === 'upgrades') renderUpgrades();
  if (pageId === 'missions') renderMissions();
  if (pageId === 'ref') renderReferrals();
  if (pageId === 'stats') { renderLeagueGrid(); updateTapUI(); }
}

// ============ TOAST ============
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

// ============ FORMAT ============
function formatNum(n) {
  if (n >= 1e9) return (n/1e9).toFixed(1) + 'B';
  if (n >= 1e6) return (n/1e6).toFixed(1) + 'M';
  if (n >= 1e3) return (n/1e3).toFixed(1) + 'K';
  return Math.floor(n).toString();
}

function renderAll() {
  updateUI();
  renderMissions();
  renderReferrals();
  setupDaily();
  renderLeagueGrid();
  checkMissions();
}

// DEMO: simulate referral after 10 seconds for first-time players
if (!S.refriends.length && S.totalTaps === 0) {
  setTimeout(() => {
    if (S.totalTaps > 5) addFakeReferral();
  }, 15000);
}

// ============ START ============
init();
</script>
</body>
</html>
